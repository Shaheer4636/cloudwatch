export AWS_REGION=us-east-1
export AWS_DEFAULT_REGION=us-east-1
CLUSTER="Strata-uat-eks-OwJIPjnj"

# 1) Which namespace is used? Try both.
for NS in "AWS/ContainerInsights" "ContainerInsights" "CWAgent"; do
  echo "---- $NS node_cpu_utilization (cluster-only) ----"
  aws cloudwatch list-metrics \
    --namespace "$NS" \
    --metric-name node_cpu_utilization \
    --dimensions Name=ClusterName,Value="$CLUSTER" \
    --max-items 5
done

# 2) What dimensions exist for node_cpu_utilization?
aws cloudwatch list-metrics \
  --namespace AWS/ContainerInsights \
  --metric-name node_cpu_utilization \
  --dimensions Name=ClusterName,Value="$CLUSTER" Name=NodeName \
  --max-items 5

# If that returns nothing, try the other namespace too:
aws cloudwatch list-metrics \
  --namespace ContainerInsights \
  --metric-name node_cpu_utilization \
  --dimensions Name=ClusterName,Value="$CLUSTER" Name=NodeName \
  --max-items 5
